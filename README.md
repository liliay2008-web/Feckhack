# Веб-система распределения тем курсовых и дипломных работ

Полностью функциональная веб-система для распределения тем курсовых и дипломных работ между студентами.

## Технологический стек

### Фронтенд
- Vue.js 3 (Composition API)
- Vite
- Vue Router
- Pinia
- Tailwind CSS
- Element Plus
- GSAP / Animate.css

### Бекенд
- Node.js
- Express.js
- SQLite
- JWT аутентификация
- Multer (загрузка файлов)
- xlsx, csv-parser (парсинг файлов)
- ExcelJS, PDFKit (экспорт)

## Функционал

### Для администратора:
- Загрузка студентов из Excel/CSV файлов
- Загрузка тем из Excel/CSV файлов
- Загрузка руководителей
- Автоматическое распределение тем (рандом)
- Ручное распределение тем
- Редактирование студентов и тем
- Экспорт данных в Excel/CSV/PDF
- Фильтрация экспорта по группе, руководителю, ЦМК
- История изменений

### Для старосты:
- Просмотр списка тем
- Назначение тем студентам своей группы
- Блокировка тем на 30 минут при выборе
- Автоматическое освобождение тем при истечении времени
- Экспорт назначенных тем

## Установка и запуск

### 1. Установка зависимостей

```bash
# Установка всех зависимостей (корневая, фронтенд и бекенд)
npm run install:all
```

Или вручную:

```bash
# Корневая директория
npm install

# Фронтенд
cd frontend
npm install

# Бекенд
cd ../backend
npm install
```

### 2. Настройка переменных окружения

Создайте файл `backend/.env`:

```env
PORT=3001
JWT_SECRET=your-secret-key-change-in-production
JWT_EXPIRES_IN=7d
```

### 3. Запуск приложения

#### Запуск всего приложения одновременно:

```bash
npm run dev
```

#### Запуск отдельно:

```bash
# Фронтенд (порт 3000)
cd frontend
npm run dev

# Бекенд (порт 3001)
cd backend
npm run dev
```

### 4. Доступ к приложению

- Фронтенд: http://localhost:3000
- Бекенд API: http://localhost:3001/api

## Структура проекта

```
├── frontend/                 # Vue.js приложение
│   ├── src/
│   │   ├── components/      # Компоненты
│   │   │   ├── admin/       # Компоненты админа
│   │   │   └── starosta/    # Компоненты старосты
│   │   ├── views/           # Страницы
│   │   ├── stores/          # Pinia stores
│   │   ├── router/          # Vue Router
│   │   ├── api/             # API клиент
│   │   └── style.css        # Стили
│   └── package.json
├── backend/                  # Express.js сервер
│   ├── routes/              # API маршруты
│   ├── database/            # База данных
│   ├── middleware/          # Middleware
│   ├── utils/               # Утилиты
│   └── server.js            # Главный файл сервера
└── package.json
```

## Формат файлов для загрузки

### Студенты (Excel/CSV)
Должен содержать колонки:
- `ФИО` или `ФИО студента` или `full_name`
- `Группа` или `group_name` или `Группа студента`
- `Телефон` или `phone` или `Номер телефона` (опционально)

### Темы (Excel/CSV)
Должен содержать колонки:
- `Название` или `Тема` или `title` или `Название темы`
- `Руководитель` или `supervisor` или `Научный руководитель` (опционально)

### Руководители (Excel/CSV)
Должен содержать колонки:
- `ФИО` или `Руководитель` или `full_name` или `Научный руководитель`

## Особенности

### Блокировка тем на 30 минут
Когда староста выбирает тему для назначения:
1. Тема блокируется на 30 минут
2. Другие старосты не могут выбрать эту тему
3. Если в течение 30 минут не заполнены все поля (кроме руководителя), тема автоматически освобождается
4. Таймер отображается в реальном времени

### Автоматическая очистка блокировок
Система автоматически очищает истекшие блокировки каждые 5 минут.

## API Endpoints

### Аутентификация
- `POST /api/auth/register` - Регистрация
- `POST /api/auth/login` - Авторизация
- `GET /api/auth/me` - Получение текущего пользователя

### Студенты
- `GET /api/students` - Получить всех студентов
- `POST /api/students/upload` - Загрузить студентов из файла
- `PUT /api/students/:id` - Обновить студента
- `DELETE /api/students/:id` - Удалить студента

### Темы
- `GET /api/topics` - Получить все темы
- `POST /api/topics/upload` - Загрузить темы из файла
- `PUT /api/topics/:id` - Обновить тему
- `POST /api/topics/:id/assign` - Назначить тему студенту
- `POST /api/topics/:id/complete` - Завершить назначение темы
- `DELETE /api/topics/:id` - Удалить тему

### Распределение
- `POST /api/distribution/auto` - Автоматическое распределение
- `GET /api/distribution/stats` - Статистика распределения

### Экспорт
- `GET /api/export/excel` - Экспорт в Excel/CSV
- `GET /api/export/pdf` - Экспорт в PDF
- `GET /api/export/filters` - Получить фильтры для экспорта

### История
- `GET /api/history` - Получить историю изменений
- `GET /api/history/student/:id` - История по студенту
- `GET /api/history/topic/:id` - История по теме

### Руководители
- `GET /api/supervisors` - Получить всех руководителей
- `POST /api/supervisors/upload` - Загрузить руководителей из файла
- `POST /api/supervisors` - Создать руководителя
- `DELETE /api/supervisors/:id` - Удалить руководителя

## Разработка

### Добавление новых функций

1. Создайте новый компонент во `frontend/src/components/`
2. Добавьте маршрут в `frontend/src/router/index.js`
3. Создайте API endpoint в `backend/routes/`
4. Обновите базу данных при необходимости

### База данных

База данных SQLite создается автоматически при первом запуске. Файл базы данных: `backend/database/database.sqlite`

## Лицензия

MIT

## Автор

Разработано для ФЭК РГЭУ (РИНХ)
